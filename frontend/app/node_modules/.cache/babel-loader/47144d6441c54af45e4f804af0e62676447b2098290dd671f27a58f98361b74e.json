{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import RessourceService from\"../services/ressourceService\";import\"./refrentialPage.css\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faEye,faTrash,faBan,faPlay}from\"@fortawesome/free-solid-svg-icons\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ReferentielPage=()=>{const storedUser=sessionStorage.getItem(\"User\");const user=storedUser?JSON.parse(storedUser).user:null;const isForbidden=user&&user.Id_Role<3;const[ressources,setRessources]=useState([]);useEffect(()=>{if(!isForbidden){const fetchRessources=async()=>{try{const res=await RessourceService.getAllRessourcesForListing();setRessources(res);}catch(error){console.log(\"Erreur lors de la récupération des ressources :\",error);}};fetchRessources();}},[isForbidden]);const handleDeleteRessource=async id=>{const isConfirmed=window.confirm(\"Voulez-vous vraiment supprimer cette ressource ?\");if(isConfirmed){try{await RessourceService.deleteRessource(id);const updatedRessources=ressources.filter(ressource=>ressource.Id_Ressource!==id);setRessources(updatedRessources);}catch(error){console.log(\"Erreur lors de la suppression de la ressource :\",error);}}};const navigate=useNavigate();const handleNavigateRessource=id=>{navigate(\"/ressource/\".concat(id));};const handleSetStatusRessource=async ressource=>{const isConfirmed=window.confirm(\"Voulez-vous vraiment modifier le statut de cette ressource ?\");if(isConfirmed){try{const newStatus=ressource.State_Ressource===\"Active\"?\"Inactive\":\"Active\";const updatedRessource={...ressource,State_Ressource:newStatus};await RessourceService.updateStatus(updatedRessource);const updatedRessources=ressources.map(r=>{if(r.Id_Ressource===ressource.Id_Ressource){return updatedRessource;}return r;});setRessources(updatedRessources);}catch(error){console.log(\"Erreur lors de la modification du statut de la ressource :\",error);}}};return/*#__PURE__*/_jsx(\"div\",{className:\"referentiel-page\",children:isForbidden?/*#__PURE__*/_jsx(\"h1\",{children:\"INTERDIT\"}):/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"ressources-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Titre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"voir\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Suspendre / Activer\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Supprimer\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:ressources.map((ressource,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:ressource.Title_Ressource}),/*#__PURE__*/_jsx(\"td\",{children:ressource.Description_Ressource}),/*#__PURE__*/_jsx(\"td\",{children:ressource.Type_Ressource}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"action-button see\",children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faEye,onClick:()=>handleNavigateRessource(ressource.Id_Ressource)})})}),/*#__PURE__*/_jsx(\"td\",{children:ressource.State_Ressource===\"Active\"?/*#__PURE__*/_jsx(\"button\",{className:\"action-button ban\",onClick:()=>handleSetStatusRessource(ressource),children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faBan})}):/*#__PURE__*/_jsx(\"button\",{className:\"action-button activate\",onClick:()=>handleSetStatusRessource(ressource),children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faPlay})})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"action-button delete\",onClick:()=>handleDeleteRessource(ressource.Id_Ressource),children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTrash})})})]},index))})]})})});};export default ReferentielPage;","map":{"version":3,"names":["React","useEffect","useState","RessourceService","FontAwesomeIcon","faEye","faTrash","faBan","faPlay","useNavigate","jsx","_jsx","jsxs","_jsxs","ReferentielPage","storedUser","sessionStorage","getItem","user","JSON","parse","isForbidden","Id_Role","ressources","setRessources","fetchRessources","res","getAllRessourcesForListing","error","console","log","handleDeleteRessource","id","isConfirmed","window","confirm","deleteRessource","updatedRessources","filter","ressource","Id_Ressource","navigate","handleNavigateRessource","concat","handleSetStatusRessource","newStatus","State_Ressource","updatedRessource","updateStatus","map","r","className","children","index","Title_Ressource","Description_Ressource","Type_Ressource","icon","onClick"],"sources":["/usr/src/app/src/page/referentialPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport RessourceService from \"../services/ressourceService\";\r\nimport \"./refrentialPage.css\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport {\r\n  faEye,\r\n  faTrash,\r\n  faBan,\r\n  faPlay,\r\n} from \"@fortawesome/free-solid-svg-icons\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst ReferentielPage: React.FC = () => {\r\n  const storedUser: string | null = sessionStorage.getItem(\"User\");\r\n  const user = storedUser ? JSON.parse(storedUser).user : null;\r\n  const isForbidden = user && user.Id_Role < 3;\r\n  const [ressources, setRessources] = useState<any[]>([]);\r\n\r\n  useEffect(() => {\r\n    if (!isForbidden) {\r\n      const fetchRessources = async () => {\r\n        try {\r\n          const res = await RessourceService.getAllRessourcesForListing();\r\n          setRessources(res);\r\n        } catch (error) {\r\n          console.log(\"Erreur lors de la récupération des ressources :\", error);\r\n        }\r\n      };\r\n\r\n      fetchRessources();\r\n    }\r\n  }, [isForbidden]);\r\n\r\n  const handleDeleteRessource = async (id: number) => {\r\n    const isConfirmed = window.confirm(\r\n      \"Voulez-vous vraiment supprimer cette ressource ?\"\r\n    );\r\n    if (isConfirmed) {\r\n      try {\r\n        await RessourceService.deleteRessource(id);\r\n        const updatedRessources = ressources.filter(\r\n          (ressource) => ressource.Id_Ressource !== id\r\n        );\r\n        setRessources(updatedRessources);\r\n      } catch (error) {\r\n        console.log(\"Erreur lors de la suppression de la ressource :\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const navigate = useNavigate();\r\n  const handleNavigateRessource = (id: any) => {\r\n    navigate(`/ressource/${id}`);\r\n  };\r\n\r\n  const handleSetStatusRessource = async (ressource: any) => {\r\n    const isConfirmed = window.confirm(\r\n      \"Voulez-vous vraiment modifier le statut de cette ressource ?\"\r\n    );\r\n    if (isConfirmed) {\r\n      try {\r\n        const newStatus =\r\n          ressource.State_Ressource === \"Active\" ? \"Inactive\" : \"Active\";\r\n        const updatedRessource = { ...ressource, State_Ressource: newStatus };\r\n        await RessourceService.updateStatus(updatedRessource);\r\n        const updatedRessources = ressources.map((r: any) => {\r\n          if (r.Id_Ressource === ressource.Id_Ressource) {\r\n            return updatedRessource;\r\n          }\r\n          return r;\r\n        });\r\n        setRessources(updatedRessources);\r\n      } catch (error) {\r\n        console.log(\r\n          \"Erreur lors de la modification du statut de la ressource :\",\r\n          error\r\n        );\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"referentiel-page\">\r\n      {isForbidden ? (\r\n        <h1>INTERDIT</h1>\r\n      ) : (\r\n        <div className=\"table-wrapper\">\r\n          <table className=\"ressources-table\">\r\n            <thead>\r\n              <tr>\r\n                <th>Titre</th>\r\n                <th>Description</th>\r\n                <th>Type</th>\r\n                <th>voir</th>\r\n                <th>Suspendre / Activer</th>\r\n                <th>Supprimer</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {ressources.map((ressource: any, index: number) => (\r\n                <tr key={index}>\r\n                  <td>{ressource.Title_Ressource}</td>\r\n                  <td>{ressource.Description_Ressource}</td>\r\n                  <td>{ressource.Type_Ressource}</td>\r\n                  <td>\r\n                    <button className=\"action-button see\">\r\n                      <FontAwesomeIcon\r\n                        icon={faEye}\r\n                        onClick={() =>\r\n                          handleNavigateRessource(ressource.Id_Ressource)\r\n                        }\r\n                      />\r\n                    </button>\r\n                  </td>\r\n                  <td>\r\n                    {ressource.State_Ressource === \"Active\" ? (\r\n                      <button\r\n                        className=\"action-button ban\"\r\n                        onClick={() => handleSetStatusRessource(ressource)}\r\n                      >\r\n                        <FontAwesomeIcon icon={faBan} />\r\n                      </button>\r\n                    ) : (\r\n                      <button\r\n                        className=\"action-button activate\"\r\n                        onClick={() => handleSetStatusRessource(ressource)}\r\n                      >\r\n                        <FontAwesomeIcon icon={faPlay} />\r\n                      </button>\r\n                    )}\r\n                  </td>\r\n                  <td>\r\n                    <button\r\n                      className=\"action-button delete\"\r\n                      onClick={() =>\r\n                        handleDeleteRessource(ressource.Id_Ressource)\r\n                      }\r\n                    >\r\n                      <FontAwesomeIcon icon={faTrash} />\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReferentielPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}