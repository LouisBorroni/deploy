{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import RessourceService from\"../services/ressourceService\";import\"./approvePage.css\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faBan,faCheck,faTrash,faEye}from\"@fortawesome/free-solid-svg-icons\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ApprovePage=()=>{const storedUser=sessionStorage.getItem(\"User\");const user=storedUser?JSON.parse(storedUser).user:null;const isForbidden=user&&user.Id_Role<2;const[ressources,setRessources]=useState([]);useEffect(()=>{if(!isForbidden){const fetchRessources=async()=>{try{const res=await RessourceService.getAllRessourcesForApproving();setRessources(res);}catch(error){console.log(\"Erreur lors de la récupération des ressources :\",error);}};fetchRessources();}},[isForbidden]);const handleDeleteRessource=async id=>{const isConfirmed=window.confirm(\"Voulez-vous vraiment supprimer cette ressource ?\");if(isConfirmed){try{await RessourceService.deleteRessource(id);const updatedRessources=ressources.filter(ressource=>ressource.Id_Ressource!==id);setRessources(updatedRessources);}catch(error){console.log(\"Erreur lors de la suppression de la ressource :\",error);}}};const handleSetStatusRessource=async(ressource,newStatus)=>{try{const updatedRessource={...ressource,State_Ressource:newStatus};await RessourceService.updateStatus(updatedRessource);const updatedRessources=ressources.filter(r=>r.Id_Ressource!==ressource.Id_Ressource);setRessources(updatedRessources);}catch(error){console.log(\"Erreur lors de la modification du statut de la ressource :\",error);}};const navigate=useNavigate();const handleNavigateRessource=id=>{navigate(\"/ressource/\".concat(id));};return/*#__PURE__*/_jsx(\"div\",{className:\"approve-page\",children:isForbidden?/*#__PURE__*/_jsx(\"h1\",{children:\"INTERDIT\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Approuver les ressources\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:ressources.length>0?/*#__PURE__*/_jsxs(\"table\",{className:\"ressources-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Titre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Voir\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Approuver\"}),/*#__PURE__*/_jsx(\"th\",{children:\"D\\xE9sactiver\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Supprimer\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:ressources.map((ressource,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:ressource.Title_Ressource}),/*#__PURE__*/_jsx(\"td\",{children:ressource.Description_Ressource}),/*#__PURE__*/_jsx(\"td\",{children:ressource.Type_Ressource}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"action-button check\",onClick:()=>handleNavigateRessource(ressource.Id_Ressource),children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faEye})})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"action-button check\",onClick:()=>handleSetStatusRessource(ressource,\"Active\"),children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faCheck})})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"action-button ban\",onClick:()=>handleSetStatusRessource(ressource,\"Inactive\"),children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faBan})})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"action-button delete\",onClick:()=>handleDeleteRessource(ressource.Id_Ressource),children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTrash})})})]},index))})]}):/*#__PURE__*/_jsx(\"p\",{children:\"Aucune ressource \\xE0 approuver pour le moment\"})})]})});};export default ApprovePage;","map":{"version":3,"names":["React","useEffect","useState","RessourceService","FontAwesomeIcon","faBan","faCheck","faTrash","faEye","useNavigate","jsx","_jsx","jsxs","_jsxs","ApprovePage","storedUser","sessionStorage","getItem","user","JSON","parse","isForbidden","Id_Role","ressources","setRessources","fetchRessources","res","getAllRessourcesForApproving","error","console","log","handleDeleteRessource","id","isConfirmed","window","confirm","deleteRessource","updatedRessources","filter","ressource","Id_Ressource","handleSetStatusRessource","newStatus","updatedRessource","State_Ressource","updateStatus","r","navigate","handleNavigateRessource","concat","className","children","length","map","index","Title_Ressource","Description_Ressource","Type_Ressource","onClick","icon"],"sources":["/usr/src/app/src/page/approvePage.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport RessourceService from \"../services/ressourceService\";\r\nimport \"./approvePage.css\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faBan, faCheck, faTrash, faEye } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst ApprovePage: React.FC = () => {\r\n  const storedUser: string | null = sessionStorage.getItem(\"User\");\r\n  const user = storedUser ? JSON.parse(storedUser).user : null;\r\n  const isForbidden = user && user.Id_Role < 2;\r\n  const [ressources, setRessources] = useState<any[]>([]);\r\n  useEffect(() => {\r\n    if (!isForbidden) {\r\n      const fetchRessources = async () => {\r\n        try {\r\n          const res = await RessourceService.getAllRessourcesForApproving();\r\n          setRessources(res); \r\n        } catch (error) {\r\n          console.log(\"Erreur lors de la récupération des ressources :\", error);\r\n        }\r\n      };\r\n\r\n      fetchRessources();\r\n    }\r\n  }, [isForbidden]);\r\n\r\n  const handleDeleteRessource = async (id: number) => {\r\n    const isConfirmed = window.confirm(\r\n      \"Voulez-vous vraiment supprimer cette ressource ?\"\r\n    );\r\n    if (isConfirmed) {\r\n      try {\r\n        await RessourceService.deleteRessource(id);\r\n        const updatedRessources = ressources.filter(\r\n          (ressource) => ressource.Id_Ressource !== id\r\n        );\r\n        setRessources(updatedRessources);\r\n      } catch (error) {\r\n        console.log(\"Erreur lors de la suppression de la ressource :\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleSetStatusRessource = async (\r\n    ressource: any,\r\n    newStatus: string\r\n  ) => {\r\n    try {\r\n      const updatedRessource = { ...ressource, State_Ressource: newStatus };\r\n      await RessourceService.updateStatus(updatedRessource);\r\n      const updatedRessources = ressources.filter(\r\n        (r) => r.Id_Ressource !== ressource.Id_Ressource\r\n      );\r\n      setRessources(updatedRessources);\r\n    } catch (error) {\r\n      console.log(\r\n        \"Erreur lors de la modification du statut de la ressource :\",\r\n        error\r\n      );\r\n    }\r\n  };\r\n\r\n  const navigate = useNavigate();\r\n  const handleNavigateRessource = (id: any) => {\r\n    navigate(`/ressource/${id}`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"approve-page\">\r\n      {isForbidden ? (\r\n        <h1>INTERDIT</h1>\r\n      ) : (\r\n        <div>\r\n          <h1>Approuver les ressources</h1>\r\n          <div className=\"table-wrapper\">\r\n            {ressources.length > 0 ? (\r\n              <table className=\"ressources-table\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>Titre</th>\r\n                    <th>Description</th>\r\n                    <th>Type</th>\r\n                    <th>Voir</th>\r\n                    <th>Approuver</th>\r\n                    <th>Désactiver</th>\r\n                    <th>Supprimer</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {ressources.map((ressource: any, index: number) => (\r\n                    <tr key={index}>\r\n                      <td>{ressource.Title_Ressource}</td>\r\n                      <td>{ressource.Description_Ressource}</td>\r\n                      <td>{ressource.Type_Ressource}</td>\r\n                      <td>\r\n                        <button\r\n                          className=\"action-button check\"\r\n                          onClick={() =>\r\n                            handleNavigateRessource(ressource.Id_Ressource)\r\n                          }\r\n                        >\r\n                          <FontAwesomeIcon icon={faEye} />\r\n                        </button>\r\n                      </td>\r\n                      <td>\r\n                        <button\r\n                          className=\"action-button check\"\r\n                          onClick={() =>\r\n                            handleSetStatusRessource(ressource, \"Active\")\r\n                          }\r\n                        >\r\n                          <FontAwesomeIcon icon={faCheck} />\r\n                        </button>\r\n                      </td>\r\n                      <td>\r\n                        <button\r\n                          className=\"action-button ban\"\r\n                          onClick={() =>\r\n                            handleSetStatusRessource(ressource, \"Inactive\")\r\n                          }\r\n                        >\r\n                          <FontAwesomeIcon icon={faBan} />\r\n                        </button>\r\n                      </td>\r\n                      <td>\r\n                        <button\r\n                          className=\"action-button delete\"\r\n                          onClick={() =>\r\n                            handleDeleteRessource(ressource.Id_Ressource)\r\n                          }\r\n                        >\r\n                          <FontAwesomeIcon icon={faTrash} />\r\n                        </button>\r\n                      </td>\r\n                    </tr>\r\n                  ))}\r\n                </tbody>\r\n              </table>\r\n            ) : (\r\n              <p>Aucune ressource à approuver pour le moment</p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ApprovePage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}