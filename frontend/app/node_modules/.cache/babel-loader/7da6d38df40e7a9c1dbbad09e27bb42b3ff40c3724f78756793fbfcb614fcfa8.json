{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import\"./categoryPage.css\";import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import{faPlus,faTrash}from\"@fortawesome/free-solid-svg-icons\";import CategoryService from\"../services/categoryService\";import{PrimaryButton}from\"../components/common/PrimaryButton/PrimaryButton\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const CategoryPage=()=>{const storedUser=sessionStorage.getItem(\"User\");const user=storedUser?JSON.parse(storedUser).user:null;const isForbidden=user&&user.Id_Role<2;// State local pour stocker les categories\nconst[categories,setCategories]=useState([]);// TODO ajouter un type \nconst[showModal,setShowModal]=useState(false);const[newCategoryTitle,setNewCategoryTitle]=useState(\"\");useEffect(()=>{if(!isForbidden){const fetchCategories=async()=>{try{const res=await CategoryService.getAllCategory();setCategories(res);}catch(error){console.log(\"Erreur lors de la récupération des category :\",error);}};fetchCategories();}},[isForbidden]);const handleDeleteCategory=async id=>{const isConfirmed=window.confirm(\"Voulez-vous vraiment supprimer cette categorie ?\");if(isConfirmed){try{await CategoryService.deleteCategory(id);const updatedCategories=categories.filter(category=>category.Id_Category!==id);setCategories(updatedCategories);}catch(error){console.log(\"Erreur lors de la suppression de la categorie :\",error);}}};const handleAddCategory=async()=>{setShowModal(true);};const handleCloseModal=()=>{setShowModal(false);setNewCategoryTitle(\"\");// Réinitialiser le titre de la nouvelle catégorie\n};const handleSaveCategory=async()=>{try{console.log(newCategoryTitle);await CategoryService.addCategory({Title_Category:newCategoryTitle});setShowModal(false);setNewCategoryTitle(\"\");// Réinitialiser le titre de la nouvelle catégorie\n// Rafraîchir la liste des catégories\nconst res=await CategoryService.getAllCategory();setCategories(res);}catch(error){console.log(\"Erreur lors de l'ajout de la catégorie :\",error);}};return/*#__PURE__*/_jsx(\"div\",{className:\"category-page\",children:isForbidden?/*#__PURE__*/_jsx(\"h1\",{children:\"INTERDIT\"}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"G\\xE9rer les cat\\xE9gories\"}),/*#__PURE__*/_jsx(PrimaryButton,{icon:faPlus,onClick:handleAddCategory,children:\"Ajouter une cat\\xE9gorie\"}),/*#__PURE__*/_jsx(\"div\",{className:\"table-wrapper\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"category-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Titre\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Supprimer\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:categories.map((category,index)=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:category.Title_Category}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"action-button delete\",onClick:()=>handleDeleteCategory(category.Id_Category),children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:faTrash})})})]},index))})]})}),showModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal-content\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"close\",onClick:handleCloseModal,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Ajouter une cat\\xE9gorie\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Titre de la cat\\xE9gorie\",value:newCategoryTitle,onChange:e=>setNewCategoryTitle(e.target.value)}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSaveCategory,children:\"Valider\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCloseModal,children:\"Annuler\"})]})]})})]})});};export default CategoryPage;","map":{"version":3,"names":["React","useEffect","useState","FontAwesomeIcon","faPlus","faTrash","CategoryService","PrimaryButton","jsx","_jsx","jsxs","_jsxs","CategoryPage","storedUser","sessionStorage","getItem","user","JSON","parse","isForbidden","Id_Role","categories","setCategories","showModal","setShowModal","newCategoryTitle","setNewCategoryTitle","fetchCategories","res","getAllCategory","error","console","log","handleDeleteCategory","id","isConfirmed","window","confirm","deleteCategory","updatedCategories","filter","category","Id_Category","handleAddCategory","handleCloseModal","handleSaveCategory","addCategory","Title_Category","className","children","icon","onClick","map","index","type","placeholder","value","onChange","e","target"],"sources":["/usr/src/app/src/page/categoryPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport \"./categoryPage.css\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faBan, faCheck, faPlus, faTrash } from \"@fortawesome/free-solid-svg-icons\";\r\nimport CategoryService from \"../services/categoryService\";\r\nimport { PrimaryButton } from \"../components/common/PrimaryButton/PrimaryButton\";\r\n\r\nconst CategoryPage: React.FC = () => {\r\n  const storedUser: string | null = sessionStorage.getItem(\"User\");\r\n  const user = storedUser ? JSON.parse(storedUser).user : null;\r\n  const isForbidden = user && user.Id_Role < 2;\r\n\r\n  // State local pour stocker les categories\r\n  const [categories, setCategories] = useState<any[]>([]); // TODO ajouter un type \r\n  const [showModal, setShowModal] = useState(false);\r\n  const [newCategoryTitle, setNewCategoryTitle] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    if (!isForbidden) {\r\n      const fetchCategories = async () => {\r\n        try {\r\n          const res = await CategoryService.getAllCategory();\r\n          setCategories(res);\r\n        } catch (error) {\r\n          console.log(\"Erreur lors de la récupération des category :\", error);\r\n        }\r\n      };\r\n\r\n      fetchCategories();\r\n    }\r\n  }, [isForbidden]);\r\n\r\n  const handleDeleteCategory = async (id: number) => {\r\n    const isConfirmed = window.confirm(\"Voulez-vous vraiment supprimer cette categorie ?\");\r\n    if (isConfirmed) {\r\n      try {\r\n        await CategoryService.deleteCategory(id);\r\n        const updatedCategories = categories.filter((category) => category.Id_Category !== id);\r\n        setCategories(updatedCategories);\r\n      } catch (error) {\r\n        console.log(\"Erreur lors de la suppression de la categorie :\", error);\r\n      }\r\n    }\r\n  };\r\n  \r\n\r\n  const handleAddCategory = async () => {\r\n    setShowModal(true);\r\n  };\r\n\r\n  const handleCloseModal = () => {\r\n    setShowModal(false);\r\n    setNewCategoryTitle(\"\"); // Réinitialiser le titre de la nouvelle catégorie\r\n  };\r\n\r\n  const handleSaveCategory = async () => {\r\n    try {\r\n        console.log(newCategoryTitle)\r\n      await CategoryService.addCategory({ Title_Category: newCategoryTitle });\r\n      setShowModal(false);\r\n      setNewCategoryTitle(\"\"); // Réinitialiser le titre de la nouvelle catégorie\r\n      // Rafraîchir la liste des catégories\r\n      const res = await CategoryService.getAllCategory();\r\n      setCategories(res);\r\n    } catch (error) {\r\n      console.log(\"Erreur lors de l'ajout de la catégorie :\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"category-page\">\r\n      {isForbidden ? (\r\n        <h1>INTERDIT</h1> \r\n      ) : (\r\n        <div>\r\n          <h1>Gérer les catégories</h1>\r\n          <PrimaryButton icon={faPlus} onClick={handleAddCategory}>Ajouter une catégorie</PrimaryButton>\r\n          <div className=\"table-wrapper\">\r\n            <table className=\"category-table\">\r\n              <thead>\r\n                <tr>\r\n                  <th>Titre</th>\r\n                  <th>Supprimer</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {categories.map((category: any, index: number) => (\r\n                  <tr key={index}>\r\n                    <td>{category.Title_Category}</td>\r\n                    <td>\r\n                      <button className=\"action-button delete\" onClick={() => handleDeleteCategory(category.Id_Category)}> \r\n                        <FontAwesomeIcon icon={faTrash}/>\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          {showModal && (\r\n            <div className=\"modal\">\r\n              <div className=\"modal-content\">\r\n                <span className=\"close\" onClick={handleCloseModal}>&times;</span>\r\n                <h2>Ajouter une catégorie</h2>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Titre de la catégorie\"\r\n                  value={newCategoryTitle}\r\n                  onChange={(e) => setNewCategoryTitle(e.target.value)}\r\n                />\r\n                <div className=\"modal-buttons\">\r\n                  <button onClick={handleSaveCategory}>Valider</button>\r\n                  <button onClick={handleCloseModal}>Annuler</button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CategoryPage;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,oBAAoB,CAC3B,OAASC,eAAe,KAAQ,gCAAgC,CAChE,OAAyBC,MAAM,CAAEC,OAAO,KAAQ,mCAAmC,CACnF,MAAO,CAAAC,eAAe,KAAM,6BAA6B,CACzD,OAASC,aAAa,KAAQ,kDAAkD,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEjF,KAAM,CAAAC,YAAsB,CAAGA,CAAA,GAAM,CACnC,KAAM,CAAAC,UAAyB,CAAGC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CAChE,KAAM,CAAAC,IAAI,CAAGH,UAAU,CAAGI,IAAI,CAACC,KAAK,CAACL,UAAU,CAAC,CAACG,IAAI,CAAG,IAAI,CAC5D,KAAM,CAAAG,WAAW,CAAGH,IAAI,EAAIA,IAAI,CAACI,OAAO,CAAG,CAAC,CAE5C;AACA,KAAM,CAACC,UAAU,CAAEC,aAAa,CAAC,CAAGpB,QAAQ,CAAQ,EAAE,CAAC,CAAE;AACzD,KAAM,CAACqB,SAAS,CAAEC,YAAY,CAAC,CAAGtB,QAAQ,CAAC,KAAK,CAAC,CACjD,KAAM,CAACuB,gBAAgB,CAAEC,mBAAmB,CAAC,CAAGxB,QAAQ,CAAC,EAAE,CAAC,CAE5DD,SAAS,CAAC,IAAM,CACd,GAAI,CAACkB,WAAW,CAAE,CAChB,KAAM,CAAAQ,eAAe,CAAG,KAAAA,CAAA,GAAY,CAClC,GAAI,CACF,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAtB,eAAe,CAACuB,cAAc,CAAC,CAAC,CAClDP,aAAa,CAACM,GAAG,CAAC,CACpB,CAAE,MAAOE,KAAK,CAAE,CACdC,OAAO,CAACC,GAAG,CAAC,+CAA+C,CAAEF,KAAK,CAAC,CACrE,CACF,CAAC,CAEDH,eAAe,CAAC,CAAC,CACnB,CACF,CAAC,CAAE,CAACR,WAAW,CAAC,CAAC,CAEjB,KAAM,CAAAc,oBAAoB,CAAG,KAAO,CAAAC,EAAU,EAAK,CACjD,KAAM,CAAAC,WAAW,CAAGC,MAAM,CAACC,OAAO,CAAC,kDAAkD,CAAC,CACtF,GAAIF,WAAW,CAAE,CACf,GAAI,CACF,KAAM,CAAA7B,eAAe,CAACgC,cAAc,CAACJ,EAAE,CAAC,CACxC,KAAM,CAAAK,iBAAiB,CAAGlB,UAAU,CAACmB,MAAM,CAAEC,QAAQ,EAAKA,QAAQ,CAACC,WAAW,GAAKR,EAAE,CAAC,CACtFZ,aAAa,CAACiB,iBAAiB,CAAC,CAClC,CAAE,MAAOT,KAAK,CAAE,CACdC,OAAO,CAACC,GAAG,CAAC,iDAAiD,CAAEF,KAAK,CAAC,CACvE,CACF,CACF,CAAC,CAGD,KAAM,CAAAa,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpCnB,YAAY,CAAC,IAAI,CAAC,CACpB,CAAC,CAED,KAAM,CAAAoB,gBAAgB,CAAGA,CAAA,GAAM,CAC7BpB,YAAY,CAAC,KAAK,CAAC,CACnBE,mBAAmB,CAAC,EAAE,CAAC,CAAE;AAC3B,CAAC,CAED,KAAM,CAAAmB,kBAAkB,CAAG,KAAAA,CAAA,GAAY,CACrC,GAAI,CACAd,OAAO,CAACC,GAAG,CAACP,gBAAgB,CAAC,CAC/B,KAAM,CAAAnB,eAAe,CAACwC,WAAW,CAAC,CAAEC,cAAc,CAAEtB,gBAAiB,CAAC,CAAC,CACvED,YAAY,CAAC,KAAK,CAAC,CACnBE,mBAAmB,CAAC,EAAE,CAAC,CAAE;AACzB;AACA,KAAM,CAAAE,GAAG,CAAG,KAAM,CAAAtB,eAAe,CAACuB,cAAc,CAAC,CAAC,CAClDP,aAAa,CAACM,GAAG,CAAC,CACpB,CAAE,MAAOE,KAAK,CAAE,CACdC,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAEF,KAAK,CAAC,CAChE,CACF,CAAC,CAED,mBACErB,IAAA,QAAKuC,SAAS,CAAC,eAAe,CAAAC,QAAA,CAC3B9B,WAAW,cACVV,IAAA,OAAAwC,QAAA,CAAI,UAAQ,CAAI,CAAC,cAEjBtC,KAAA,QAAAsC,QAAA,eACExC,IAAA,OAAAwC,QAAA,CAAI,4BAAoB,CAAI,CAAC,cAC7BxC,IAAA,CAACF,aAAa,EAAC2C,IAAI,CAAE9C,MAAO,CAAC+C,OAAO,CAAER,iBAAkB,CAAAM,QAAA,CAAC,0BAAqB,CAAe,CAAC,cAC9FxC,IAAA,QAAKuC,SAAS,CAAC,eAAe,CAAAC,QAAA,cAC5BtC,KAAA,UAAOqC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC/BxC,IAAA,UAAAwC,QAAA,cACEtC,KAAA,OAAAsC,QAAA,eACExC,IAAA,OAAAwC,QAAA,CAAI,OAAK,CAAI,CAAC,cACdxC,IAAA,OAAAwC,QAAA,CAAI,WAAS,CAAI,CAAC,EAChB,CAAC,CACA,CAAC,cACRxC,IAAA,UAAAwC,QAAA,CACG5B,UAAU,CAAC+B,GAAG,CAAC,CAACX,QAAa,CAAEY,KAAa,gBAC3C1C,KAAA,OAAAsC,QAAA,eACExC,IAAA,OAAAwC,QAAA,CAAKR,QAAQ,CAACM,cAAc,CAAK,CAAC,cAClCtC,IAAA,OAAAwC,QAAA,cACExC,IAAA,WAAQuC,SAAS,CAAC,sBAAsB,CAACG,OAAO,CAAEA,CAAA,GAAMlB,oBAAoB,CAACQ,QAAQ,CAACC,WAAW,CAAE,CAAAO,QAAA,cACjGxC,IAAA,CAACN,eAAe,EAAC+C,IAAI,CAAE7C,OAAQ,CAAC,CAAC,CAC3B,CAAC,CACP,CAAC,GANEgD,KAOL,CACL,CAAC,CACG,CAAC,EACH,CAAC,CACL,CAAC,CACL9B,SAAS,eACRd,IAAA,QAAKuC,SAAS,CAAC,OAAO,CAAAC,QAAA,cACpBtC,KAAA,QAAKqC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BxC,IAAA,SAAMuC,SAAS,CAAC,OAAO,CAACG,OAAO,CAAEP,gBAAiB,CAAAK,QAAA,CAAC,MAAO,CAAM,CAAC,cACjExC,IAAA,OAAAwC,QAAA,CAAI,0BAAqB,CAAI,CAAC,cAC9BxC,IAAA,UACE6C,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,0BAAuB,CACnCC,KAAK,CAAE/B,gBAAiB,CACxBgC,QAAQ,CAAGC,CAAC,EAAKhC,mBAAmB,CAACgC,CAAC,CAACC,MAAM,CAACH,KAAK,CAAE,CACtD,CAAC,cACF7C,KAAA,QAAKqC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5BxC,IAAA,WAAQ0C,OAAO,CAAEN,kBAAmB,CAAAI,QAAA,CAAC,SAAO,CAAQ,CAAC,cACrDxC,IAAA,WAAQ0C,OAAO,CAAEP,gBAAiB,CAAAK,QAAA,CAAC,SAAO,CAAQ,CAAC,EAChD,CAAC,EACH,CAAC,CACH,CACN,EACE,CACN,CACE,CAAC,CAEV,CAAC,CAED,cAAe,CAAArC,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}